version: '3'

services:
  tests:
    build: 
      context: ../../
      dockerfile: ./tests/Core/Dockerfile.tests.core
      args:
        testCategory: Cache
    image: marketplace-test-core:cache
    depends_on:
      - redis
      - memcached
    networks:
      - marketplace-test-cache-network

  redis:
    build: 
      context: ./
      dockerfile: Dockerfile.tests.redis
    image: marketplace-test-cache-redis
    networks:
      marketplace-test-cache-network:
        aliases: 
          - test-core-cache.redis.com
    ports:
      - 6379

  memcached:
    build: 
      context: ../../
      dockerfile: ./src/Core/Cache/Dockerfiles/Dockerfile.memcached
    image: maxcrank/memcached:sasl
    networks:
      marketplace-test-cache-network:
        aliases: 
          - test-core-cache.memcached.com
    ports:
      - 11211
    environment:
      SASL_PASSWORD: testCorePassword

networks: 
  marketplace-test-cache-network: